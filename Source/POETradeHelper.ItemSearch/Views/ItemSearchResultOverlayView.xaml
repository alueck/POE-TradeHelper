<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:commonUiConverters="clr-namespace:POETradeHelper.Common.UI.Converters;assembly=POETradeHelper.Common.UI"
        xmlns:localConverters="clr-namespace:POETradeHelper.ItemSearch.Converters;assembly=POETradeHelper.ItemSearch"
        mc:Ignorable="d" d:DesignWidth="400" d:DesignHeight="220"
        x:Class="POETradeHelper.ItemSearch.Views.ItemSearchResultOverlayView"
        Width="400" Height="220"
        Topmost="True"
        HasSystemDecorations="False"
        Title="Overlay"
        SizeToContent="Width">

  <Window.Resources>
    <commonUiConverters:MessageTypeToBrushConverter x:Key="messageTypeToBrushConverter" />
    <localConverters:ItemRarityToBrushConverter x:Key="itemRarityToBrushConverter" />
  </Window.Resources>

  <Window.Styles>
    <Style Selector="DataGridCell.alignRight">
      <Setter Property="HorizontalContentAlignment" Value="Right" />
    </Style>

    <!-- override DataGridRow selection and mouse over style -->

    <Style Selector="DataGridRow:pointerover /template/ Rectangle#BackgroundRectangle">
      <Setter Property="IsVisible" Value="False" />
    </Style>

    <Style Selector="DataGridRow:selected /template/ Rectangle#BackgroundRectangle">
      <Setter Property="IsVisible" Value="False" />
    </Style>

    <Style Selector="DataGridRow:selected">
    </Style>

    <!-- end - override DataGridRow selection and mouse over style -->

    <Style Selector="DataGridColumnHeader">
      <Setter Property="FontWeight" Value="Bold" />
      <Setter Property="Padding" Value="8,4" />
    </Style>
  </Window.Styles>

  <Grid Margin="10">

    <TextBlock VerticalAlignment="Center"
               HorizontalAlignment="Center"
               Text="{Binding Message.Text}"
               Foreground="{Binding Message.Type, Converter={StaticResource messageTypeToBrushConverter}}"
               IsVisible="{Binding Message, Converter={x:Static ObjectConverters.IsNotNull}}" />

    <Grid IsVisible="{Binding Message, Converter={x:Static ObjectConverters.IsNull}}">

      <Grid.ColumnDefinitions>
        <ColumnDefinition />
        <ColumnDefinition />
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition />
      </Grid.RowDefinitions>

      <TextBlock Text="{Binding ItemListings.Item.DisplayName}"
                 FontWeight="Bold"
                 Foreground="{Binding ItemListings.Item.Rarity, Converter={StaticResource itemRarityToBrushConverter}}"
                 Margin ="0,0,0,5" />

      <Button Grid.Column="1"
              Content="Open in browser"
              Command="{Binding OpenQueryInBrowserCommand}"
              Background="Transparent" BorderThickness="0"
              Padding="0"
              Margin="0,0,0,5"
              HorizontalAlignment="Right"
              Foreground="{DynamicResource ThemeAccentBrush}"
              Cursor="Hand" />

      <Grid Grid.Row="1" Grid.ColumnSpan="2">
        <DataGrid Items="{Binding ItemListings.Result}"
                  IsReadOnly="True"
                  ScrollViewer.VerticalScrollBarVisibility="Auto">
          <DataGrid.Columns>
            <DataGridTextColumn Header="Account name" Binding="{Binding Listing.Account.Name}" />
            <DataGridTextColumn Header="Item level" Binding="{Binding Item.ItemLevel}" CellStyleClasses="alignRight" />
            <DataGridTextColumn Header="Price" Binding="{Binding Listing.Price.PriceText}" />
            <DataGridTextColumn Header="Age" Binding="{Binding Listing.AgeText}" CellStyleClasses="alignRight" />
          </DataGrid.Columns>
        </DataGrid>
      </Grid>
    </Grid>
  </Grid>
</Window>